import{_ as T,I as ve,g as me}from"./index.7fc72974.js";import{d as V,i as L,c as Y,w as te,E as m,aG as A,aJ as c,aO as h,aK as d,u as f,aY as j,a_ as fe,e as D,I as t,aP as F,bp as ye,bw as be,F as B,aH as K,aM as R,aL as z,bQ as De,ah as ge,aV as Be,bR as he,b2 as G,bf as W,bg as X,bD as Ae,bS as Q,n as ae,bT as Ce,by as we,bv as Ie,G as H,be as le,bU as Se,bV as Ue,bW as Ve,bX as Re,b7 as Le,bY as Te,bc as Pe,bx as ze,ba as Oe,p as J,aX as O}from"./arco.ba71ebb9.js";import{h as re}from"./moment.ec46f3d1.js";import{o as Ne}from"./vue.a49450d0.js";import{t as N}from"./index.e58ad9f7.js";/* empty css               *//* empty css              */import{u as ie}from"./loading.069aae80.js";import{U as Ye}from"./index.7d9c86ce.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               */import"./chart.b4158a50.js";let ee;const je=new Uint8Array(16);function Me(){if(!ee&&(ee=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ee))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ee(je)}const S=[];for(let n=0;n<256;++n)S.push((n+256).toString(16).slice(1));function He(n,u=0){return(S[n[u+0]]+S[n[u+1]]+S[n[u+2]]+S[n[u+3]]+"-"+S[n[u+4]]+S[n[u+5]]+"-"+S[n[u+6]]+S[n[u+7]]+"-"+S[n[u+8]]+S[n[u+9]]+"-"+S[n[u+10]]+S[n[u+11]]+S[n[u+12]]+S[n[u+13]]+S[n[u+14]]+S[n[u+15]]).toLowerCase()}const Je=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_e={randomUUID:Je};function ue(n,u,l){if(_e.randomUUID&&!u&&!n)return _e.randomUUID();n=n||{};const e=n.random||(n.rng||Me)();if(e[6]=e[6]&15|64,e[8]=e[8]&63|128,u){l=l||0;for(let _=0;_<16;++_)u[l+_]=e[_];return u}return He(e)}const Ke=V({__name:"cart-user-list",props:{visible:{type:Boolean,default:!1}},emits:["cancel"],setup(n,{emit:u}){const l=n,{user:e,updateUser:_}=L("user"),s=Y(()=>l.visible),o=()=>{u("cancel",!1)},r=()=>{_(null),u("cancel",!1)};return te(()=>e.value,()=>{u("cancel",!1)}),(C,$)=>{const v=j,w=fe;return m(),A(w,{width:380,visible:f(s),placement:"left","unmount-on-close":"",onCancel:o},{title:c(()=>[h(" \u4F1A\u5458\u5217\u8868 ")]),footer:c(()=>[d(v,{type:"primary",size:"mini",shape:"round",onClick:r},{default:c(()=>[h("\u6E38\u5BA2")]),_:1})]),default:c(()=>[d(Ye)]),_:1},8,["visible"])}}});const Ge=T(Ke,[["__scopeId","data-v-5d16a44d"]]),We={class:"user-box"},Xe={class:"info-box"},Qe={class:"info"},qe={class:"name"},Ze={class:"price"},et={class:"button"},tt=V({__name:"cart-user",setup(n){const u=D(!1),{user:l}=L("user"),{loading:e,setLoading:_}=ie();return(s,o)=>{const r=ye,C=ve,$=j,v=be;return m(),A(v,{loading:f(e),style:{width:"100%",height:"100%"}},{default:c(()=>[t("div",We,[t("div",Xe,[f(l)?(m(),A(r,{key:0,"image-url":f(l).portrait,size:48},null,8,["image-url"])):(m(),A(r,{key:1,size:48,style:{backgroundColor:"#14a9f8"}},{default:c(()=>[d(C)]),_:1})),t("div",Qe,[t("div",qe,F(f(l)?f(l).nickname:"\u6E38\u5BA2"),1),t("div",null,[h("\u4F59\u989D"),t("span",Ze,F(f(l)?f(N)(String(f(l).money)):"0.00"),1),h("\u5143")])])]),t("div",et,[d($,{type:"primary",size:"mini",shape:"round",onClick:o[0]||(o[0]=w=>u.value=!0)},{default:c(()=>[h(F(f(l)?"\u5207\u6362\u4F1A\u5458":"\u4F1A\u5458\u767B\u5F55"),1)]),_:1})]),d(Ge,{visible:u.value,onCancel:o[1]||(o[1]=w=>u.value=!1)},null,8,["visible"])])]),_:1},8,["loading"])}}});const st=T(tt,[["__scopeId","data-v-4d0d6d32"]]),nt={class:"list-box"},ot={key:0,class:"empty"},at={class:"name-box"},ut={class:"name"},lt={class:"specification"},it={class:"total-box"},ct={class:"total"},dt={class:"price"},rt={class:"number"},_t={key:1,class:"item"},pt={class:"name-box"},vt={class:"name"},mt={class:"specification"},ft={class:"total-box"},yt={class:"total"},bt={class:"price"},gt={class:"number"},ht=V({__name:"cart-list",setup(n){const{cart:u,deleteCart:l}=L("cart"),e=Y(()=>s=>N(String(s.price*s.number))),_=(s,o=-1)=>{l(s,o)};return(s,o)=>{const r=De,C=ge,$=j,v=Be,w=he;return m(),A(w,{style:{overflow:"auto"}},{default:c(()=>[t("div",nt,[f(u).commodity.length===0?(m(),B("div",ot,[d(r,null,{default:c(()=>[h("\u6682\u65E0\u8D2D\u7269\u8F66\u5546\u54C1")]),_:1})])):K("",!0),(m(!0),B(R,null,z(f(u).commodity,(k,b)=>(m(),B(R,{key:k.id},[k.sku?(m(!0),B(R,{key:0},z(k.sku,(p,a)=>(m(),B("div",{key:p.ids,class:"item"},[t("div",at,[t("div",ut,F(p.name),1),d($,{shape:"circle",size:"mini",onClick:i=>_(b,a)},{default:c(()=>[d(C)]),_:2},1032,["onClick"])]),t("div",lt,[t("span",null,"\uFFE5"+F(p.price),1),(m(!0),B(R,null,z(p.product,(i,g)=>(m(),B("span",{key:g},F(i.value),1))),128))]),t("div",it,[t("div",ct,[h(" \u5C0F\u8BA1\uFF1A"),t("span",dt,"\uFFE5"+F(f(e)(p)),1)]),t("div",rt,[d(v,{modelValue:p.number,"onUpdate:modelValue":i=>p.number=i,max:p.inventory,min:1,style:{width:"120px"},size:"small",mode:"button"},null,8,["modelValue","onUpdate:modelValue","max"])])])]))),128)):(m(),B("div",_t,[t("div",pt,[t("div",vt,F(k.name),1),d($,{shape:"circle",size:"mini",onClick:p=>_(b)},{default:c(()=>[d(C)]),_:2},1032,["onClick"])]),t("div",mt,[t("span",null,"\uFFE5"+F(k.price),1),t("span",null,F(k.product),1)]),t("div",ft,[t("div",yt,[h(" \u5C0F\u8BA1\uFF1A"),t("span",bt,"\uFFE5"+F(f(e)(k)),1)]),t("div",gt,[d(v,{modelValue:k.number,"onUpdate:modelValue":p=>k.number=p,max:k.inventory,min:1,style:{width:"120px"},size:"small",mode:"button"},null,8,["modelValue","onUpdate:modelValue","max"])])])]))],64))),128))])]),_:1})}}});const Ct=T(ht,[["__scopeId","data-v-dd984863"]]),ke=n=>(W("data-v-8e432f81"),n=n(),X(),n),kt={class:"list-box"},Ft=["src"],$t={class:"info"},xt={class:"top"},Et={class:"nickname"},Dt={class:"operation"},Bt={class:"cellphone"},At={class:"bottom"},wt={class:"price"},It=ke(()=>t("div",null,"\u786E\u5B9A\u8981\u6E05\u7A7A\u6240\u6709\u6302\u5355\u5417\uFF1F",-1)),St=ke(()=>t("div",null,"\u6E05\u7A7A\u6240\u6709\u6302\u5355\u540E\u5C06\u65E0\u6CD5\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01",-1)),Ut=V({__name:"order-pending-list",props:{visible:{type:Boolean,default:!1}},emits:["cancel"],setup(n,{emit:u}){const l=n,{pending:e,deletePending:_,emptyPending:s}=L("pending"),{pendingToCart:o}=L("cart"),r=D(!1),C=Y(()=>l.visible),$=()=>{u("cancel",!1)},v=b=>{o(b),u("cancel",!1)},w=b=>{_(b)},k=()=>{s()};return(b,p)=>{const a=ye,i=ve,g=ge,y=j,E=G,I=fe;return m(),A(I,{width:380,visible:f(C),placement:"left","unmount-on-close":"",onCancel:$},{title:c(()=>[h(" \u6302\u5355\u5217\u8868 ")]),footer:c(()=>[d(y,{type:"primary",size:"mini",shape:"round",onClick:p[1]||(p[1]=x=>r.value=!0)},{default:c(()=>[h("\u6E05\u7A7A")]),_:1})]),default:c(()=>[t("div",kt,[(m(!0),B(R,null,z(f(e),(x,P)=>(m(),B("div",{key:x.uuid,class:"item"},[x.user?(m(),A(a,{key:0,size:56},{default:c(()=>[t("img",{alt:"avatar",src:x.user.portrait},null,8,Ft)]),_:2},1024)):(m(),A(a,{key:1,size:48,style:{backgroundColor:"#14a9f8"}},{default:c(()=>[d(i)]),_:1})),t("div",$t,[t("div",xt,[t("div",Et,F(x.user?x.user.nickname:"\u6E38\u5BA2"),1),d(y,{class:"delete",shape:"circle",size:"mini",onClick:U=>w(P)},{default:c(()=>[d(g)]),_:2},1032,["onClick"])]),t("div",Dt,[t("div",Bt,"\u624B\u673A\u53F7\uFF1A"+F(x.user?x.user.cellphone:"-"),1),d(y,{type:"primary",size:"mini",shape:"round",onClick:U=>v(x)},{default:c(()=>[h("\u63D0\u53D6")]),_:2},1032,["onClick"])]),t("div",At,[t("div",null,F(x.time),1),t("div",null,[h("\u5408\u8BA1\uFF1A"),t("span",wt,"\uFFE5"+F(x.total),1)])])])]))),128))]),d(E,{visible:r.value,"onUpdate:visible":p[0]||(p[0]=x=>r.value=x),onOk:k},{title:c(()=>[h(" \u63D0\u793A ")]),default:c(()=>[It,St]),_:1},8,["visible"])]),_:1},8,["visible"])}}});const Vt=T(Ut,[["__scopeId","data-v-8e432f81"]]),ce=n=>(W("data-v-2abb4e9d"),n=n(),X(),n),Rt={class:"bottom-box"},Lt={class:"buttom"},Tt={class:"info"},Pt={class:"number"},zt={class:"total"},Ot=ce(()=>t("span",{class:"symbol"},"\uFFE5",-1)),Nt=ce(()=>t("div",null,"\u786E\u5B9A\u8981\u6E05\u7A7A\u8BE5\u8D2D\u7269\u8F66\u5417\uFF1F",-1)),Yt=ce(()=>t("div",null,"\u6E05\u7A7A\u8BE5\u8D2D\u7269\u8F66\u540E\u5C06\u65E0\u6CD5\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01",-1)),jt=V({__name:"cart",emits:["clearing"],setup(n,{emit:u}){const{cart:l,emptyCart:e}=L("cart"),_=L("clearing"),{pending:s,addPending:o}=L("pending"),r=D(!1),C=D(!1),$=()=>{_(),u("clearing",!0)},v=Y(()=>{let b=0,p=0;return l.value.commodity.forEach(a=>{Reflect.has(a,"sku")?a.sku.forEach(i=>{b+=i.number,p+=i.number*i.price}):(b+=a.number,p+=a.number*a.price)}),{sum:b,total:p}}),w=()=>{e()},k=()=>{o()};return(b,p)=>{const a=j,i=Ae,g=G,y=Q;return m(),A(y,{class:"general-card cart-box","header-style":{paddingBottom:"0"},"body-style":{padding:"15px 15px 13px 20px"}},{default:c(()=>[d(st),d(Ct),t("div",Rt,[t("div",Lt,[t("div",null,[d(a,{style:{"margin-right":"10px"},onClick:p[0]||(p[0]=E=>r.value=!0)},{default:c(()=>[h("\u6574\u5355\u53D6\u6D88")]),_:1}),d(a,{onClick:k},{default:c(()=>[h("\u6302\u5355")]),_:1})]),d(i,{count:f(s).length},{default:c(()=>[d(a,{type:"outline",onClick:p[1]||(p[1]=E=>C.value=!0)},{default:c(()=>[h("\u6302\u5355")]),_:1})]),_:1},8,["count"])]),t("div",Tt,[t("div",Pt,[h("\u5546\u54C1\u603B\u6570\uFF1A"),t("span",null,F(f(v).sum)+"\u4EF6",1)]),t("div",zt,[h("\u5408\u8BA1\uFF1A"),t("span",null,[Ot,h(F(f(N)(String(f(v).total))),1)])])]),d(a,{type:"primary",long:"",disabled:f(l).commodity.length===0,onClick:$},{default:c(()=>[h("\u7ED3\u7B97")]),_:1},8,["disabled"])]),d(g,{visible:r.value,"onUpdate:visible":p[2]||(p[2]=E=>r.value=E),onOk:w},{title:c(()=>[h(" \u63D0\u793A ")]),default:c(()=>[Nt,Yt]),_:1},8,["visible"]),d(Vt,{visible:C.value,onCancel:p[3]||(p[3]=E=>C.value=!1)},null,8,["visible"])]),_:1})}}});const Mt=T(jt,[["__scopeId","data-v-2abb4e9d"]]),Ht=V({__name:"commodity-search",emits:["keywordInput"],setup(n,{emit:u}){const l=D();function e(_){u("keywordInput",_)}return ae(()=>{l.value.focus()}),(_,s)=>{const o=Ce,r=Q;return m(),A(r,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"15px"}},{default:c(()=>[d(o,{ref_key:"keywordRef",ref:l,placeholder:"\u641C\u7D22\u5546\u54C1\u540D\u79F0/\u8D27\u53F7\u6216\u70B9\u51FB\u805A\u7126\u626B\u7801","allow-clear":"",onChange:e},null,512)]),_:1})}}});function Jt(n){return me.get("/api/commodity/list",{params:n})}function Kt(){return me.get("/api/classify/list")}const Gt=V({__name:"commodity-classify",emits:["tabClick"],setup(n,{emit:u}){const l=D(),{loading:e,setLoading:_}=ie();async function s(){try{_(!0);const{data:r}=await Kt();l.value=r}catch{}finally{_(!1)}}s();function o(r){u("tabClick",r)}return(r,C)=>{const $=we,v=Ie,w=Q;return m(),A(w,{loading:f(e),class:"general-card classify-box","header-style":{paddingBottom:"0"},"body-style":{padding:"15px"}},{default:c(()=>[d(v,{type:"rounded","hide-content":!0,onTabClick:o},{default:c(()=>[(m(!0),B(R,null,z(l.value,k=>(m(),A($,{key:k.id,title:k.name},null,8,["title"]))),128))]),_:1})]),_:1},8,["loading"])}}});const Wt=T(Gt,[["__scopeId","data-v-681e5722"]]),Xt=n=>(W("data-v-9033cfc8"),n=n(),X(),n),Qt=Xt(()=>t("div",{class:"nothing"},"\u552E\u5B8C",-1)),qt={class:"info"},Zt={class:"name"},es={class:"price"},ts={class:"value"},ss={class:"specification"},ns={class:"name"},os={class:"option-box"},as=["onClick"],us=V({__name:"commodity-sku",props:{visible:{type:Boolean,default:!1},sku:null},emits:["cancel"],setup(n,{emit:u}){const l=n,{cart:e,updateCart:_}=L("cart"),s=D(!1);let o={};const r=D(0),C=Y(()=>l.visible),$=()=>{u("cancel",!1)},v=()=>{o.number=1,_(o),u("cancel",!1)},w=(b,p)=>{const a=o.specification;a[b].leaf.map(y=>(y.selected=!1,y)),a[b].leaf[p].selected=!0;let{ids:i}=o;i=i==null?void 0:i.split("_"),i[b]=`${a[b].id}-${a[b].leaf[p].id}`,i=i.join("_");const{productSkus:g}=o;g.forEach(y=>{y.ids===i&&(y.img&&(o.img=y.img),o.inventory=y.inventory,o.price=y.price,o.ids=i,o.product=y.product,y.inventory===0||r.value>=y.inventory?s.value=!0:s.value=!1)})},k=()=>{s.value=!1,r.value=0;const b=e.value.commodity.find(p=>p.id===o.id);if(b){const p=b.sku.find(a=>a.product.every((i,g)=>i.value===o.product[g].value));p&&(r.value=p.number,o.inventory<=p.number&&(s.value=!0))}};return te(()=>l.sku,b=>{o=b,k()}),(b,p)=>{const a=le,i=j,g=G;return m(),A(g,{visible:f(C),width:"600",draggable:"",onCancel:$},{title:c(()=>[h(" \u5546\u54C1\u89C4\u683C ")]),footer:c(()=>[d(i,{onClick:$},{default:c(()=>[h("\u53D6\u6D88")]),_:1}),d(i,{type:"primary",disabled:s.value,onClick:v},{default:c(()=>[h("\u786E\u8BA4")]),_:1},8,["disabled"])]),default:c(()=>[t("div",{class:H(["top",{no:s.value}])},[Qt,d(a,{preview:!1,width:"140px",src:f(o).img},null,8,["src"]),t("div",qt,[t("div",Zt,F(f(o).name),1),t("div",es,"\uFFE5"+F(f(o).price),1),t("div",ts,"\u5E93\u5B58\uFF1A"+F(f(o).inventory),1)])],2),t("div",ss,[(m(!0),B(R,null,z(f(o).specification,(y,E)=>(m(),B("div",{key:E},[t("div",ns,F(y.value),1),t("div",os,[(m(!0),B(R,null,z(y.leaf,(I,x)=>(m(),B("div",{key:x,class:H(["option",{on:I.selected}]),onClick:P=>w(E,x)},F(I.value),11,as))),128))])]))),128))])]),_:1},8,["visible"])}}});const ls=T(us,[["__scopeId","data-v-9033cfc8"]]);function pe(n){const u=[];return Object.keys(n).forEach(l=>{Reflect.has(n,l)&&u.push(n[l])}),u}const is=n=>n.reduce((u,l,e)=>`${u}${l.k_id}-${l.v_id}${e===n.length-1?"":"_"}`,"");function cs(n,u){if(!u||u<1)return[];const l=[],e=[];let _=!0,s,o,r;for(s=0;s<n;s+=1)e[s]=s<u?1:0;for(l.push(e.concat());_;)for(r=0,s=0;s<n-1;s+=1){if(e[s]===1&&e[s+1]===0){for(o=0;o<s;o+=1)e[o]=o<r?1:0;e[s]=0,e[s+1]=1;const C=e.concat();l.push(C),C.slice(-u).join("").indexOf("0")===-1&&(_=!1);break}e[s]===1&&(r+=1)}return l}function ds(n){if(!n||!n.length)return[];const u=n.length,l=[],e=[];for(let _=1;_<u;_+=1){const s=cs(u,_);for(;s.length;){const o=[];for(let r=0;r<u;r+=1)s.shift()&&o.push(n[r].v_id);l.push(o)}}for(let _=0;_<u;_+=1)e.push(n[_].v_id);return l.push(e),l}function rs(n){const u=[],l=[],e=n.sku.map(r=>{var $;const C={...r,productSkuId:r.id,skus:($=r==null?void 0:r.product)==null?void 0:$.map(v=>{const w=ue().replace(/[-]/g,""),k=ue().replace(/[-]/g,"");l[v.key]||(l[v.key]=w),l[v.value]||(l[v.value]=k);const b=l[v.key],p=l[v.value];return u[v.key]={value:v.key,id:b,leaf:{...u[v.key]?u[v.key].leaf:{},[v.value]:{value:v.value,id:p,selected:!1}}},{k_id:b,k:v.key,v_id:p,v:v.value}})};return{...C,ids:is(C.skus),data:ds(C.skus)}}),_=pe(u).map(r=>({...r,leaf:pe(r.leaf)}));let s={id:0,name:"",img:"",price:0,inventory:0,ids:"",number:0,product:[]},o="";return _.forEach(r=>{r.leaf[0].selected=!0,o+=`${r.id}-${r.leaf[0].id}_`}),o=o.slice(0,-1),e.forEach(r=>{r.ids===o&&(s={id:n.id,name:n.name,img:r.img?r.img:n.img,inventory:r.inventory,price:r.price,number:0,ids:o,product:r.product})}),{...s,productSkus:e,specification:_}}const _s=n=>(W("data-v-d3772beb"),n=n(),X(),n),ps={class:"list-box"},vs={class:"item-box"},ms=["onClick"],fs=_s(()=>t("div",{class:"nothing"},"\u552E\u5B8C",-1)),ys={class:"info"},bs={class:"name"},gs={class:"price"},hs={key:0,class:"badge"},Cs=V({__name:"commodity-list",props:{classifyId:{default:0},keyword:{default:""}},setup(n){const u=n,l=D(!1),e=D(),{cart:_,updateCart:s}=L("cart"),o=D(0),r=D(),C=D(),{loading:$,setLoading:v}=ie();function w(a){return rs(a)}const k=a=>{const{commodity:i}=_.value;let g=0;if(i.forEach(y=>{y.id===a.id&&(g=y.number)}),a.sku)l.value=!0,e.value=w(a);else if(a.inventory!==0&&g<a.inventory){const y=JSON.parse(JSON.stringify(a));y.number=1,s(y)}};async function b(){try{v(!0);const{data:a}=await Jt({classifyId:o.value,keyword:r.value});C.value=a,r.value&&C.value.length===1&&(k(C.value[0]),console.log("\u76F4\u63A5\u52A0\u5165\u8D2D\u7269\u8F66"))}catch{}finally{v(!1)}}const p=Y(()=>a=>{const{commodity:i}=_.value;let g=0;return i.forEach(y=>{y.id===a&&(Reflect.has(y,"sku")?y.sku.forEach(E=>{g+=E.number}):g=y.number)}),g});return te([()=>u.classifyId,()=>u.keyword],([a,i])=>{o.value=a,r.value=i,b()}),b(),(a,i)=>{const g=le,y=Se,E=Ue,I=he,x=Q,P=be;return m(),A(P,{dot:"",loading:f($),style:{width:"100%",height:"100%"}},{default:c(()=>[d(x,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"15px 5px 15px 15px"}},{default:c(()=>[d(I,{style:{"overflow-y":"auto"}},{default:c(()=>[t("div",ps,[d(E,{gutter:[10,10]},{default:c(()=>[(m(!0),B(R,null,z(C.value,(U,se)=>(m(),A(y,{key:se,xs:24,sm:24,md:24,lg:12,xl:8,xxl:6},{default:c(()=>[t("div",vs,[t("div",{class:H(["item",{no:U.inventory===0||U.inventory===f(p)(U.id)}]),onClick:de=>k(U)},[fs,d(g,{width:"100",height:"100",fit:"cover",src:U.img,preview:!1},null,8,["src"]),t("div",ys,[t("div",bs,F(U.name),1),t("div",gs,"\uFFE5"+F(f(N)(String(U.price))),1)])],10,ms),f(p)(U.id)?(m(),B("div",hs,F(f(p)(U.id)),1)):K("",!0)])]),_:2},1024))),128))]),_:1})])]),_:1}),d(ls,{sku:e.value,visible:l.value,onCancel:i[0]||(i[0]=U=>l.value=!1)},null,8,["sku","visible"])]),_:1})]),_:1},8,["loading"])}}});const ks=T(Cs,[["__scopeId","data-v-d3772beb"]]),Fs=V({__name:"commodity",setup(n){const u=D(0),l=D(),e=s=>{u.value=s},_=s=>{l.value=s};return(s,o)=>(m(),B("div",null,[d(Ht,{onKeywordInput:_}),d(Wt,{onTabClick:e}),d(ks,{"classify-id":u.value,keyword:l.value},null,8,["classify-id","keyword"])]))}});const $s="/arco-design-vue3-cashier/assets/code.2e65939a.png",xs={class:"box"},Es={class:"item-box"},Ds={class:"item-box"},Bs={class:"item-box"},As={class:"left"},ws={class:"left-box"},Is={class:"left-box"},Ss={class:"right"},Us=V({__name:"soft-keyboard",emits:["key","confirm"],setup(n,{emit:u}){const l=D(""),e=_=>{["1","2","3","4","5","6","7","8","9","0","00","10","20","50","100","."].includes(_)?l.value+=_:_==="delete"?l.value=l.value.slice(0,-1):_==="empty"&&(l.value=""),l.value||(l.value="0"),_==="confirm"?u("confirm",!0):u("key",l)};return(_,s)=>(m(),B("div",xs,[t("div",Es,[t("div",{class:"item bold",onClick:s[0]||(s[0]=o=>e("7"))},"7"),t("div",{class:"item bold",onClick:s[1]||(s[1]=o=>e("8"))},"8"),t("div",{class:"item bold",onClick:s[2]||(s[2]=o=>e("9"))},"9"),t("div",{class:"item bold red",onClick:s[3]||(s[3]=o=>e("100"))},"\uFFE5100"),t("div",{class:"item delete",onClick:s[4]||(s[4]=o=>e("delete"))},"\u5220\u9664")]),t("div",Ds,[t("div",{class:"item bold",onClick:s[5]||(s[5]=o=>e("4"))},"4"),t("div",{class:"item bold",onClick:s[6]||(s[6]=o=>e("5"))},"5"),t("div",{class:"item bold",onClick:s[7]||(s[7]=o=>e("6"))},"6"),t("div",{class:"item bold red",onClick:s[8]||(s[8]=o=>e("50"))},"\uFFE550"),t("div",{class:"item",onClick:s[9]||(s[9]=o=>e("empty"))},"\u6E05\u7A7A")]),t("div",Bs,[t("div",As,[t("div",ws,[t("div",{class:"item bold",onClick:s[10]||(s[10]=o=>e("1"))},"1"),t("div",{class:"item bold",onClick:s[11]||(s[11]=o=>e("2"))},"2"),t("div",{class:"item bold",onClick:s[12]||(s[12]=o=>e("3"))},"3"),t("div",{class:"item bold red",onClick:s[13]||(s[13]=o=>e("20"))},"\uFFE520")]),t("div",Is,[t("div",{class:"item bold",onClick:s[14]||(s[14]=o=>e("00"))},"00"),t("div",{class:"item bold",onClick:s[15]||(s[15]=o=>e("0"))},"0"),t("div",{class:"item bold",onClick:s[16]||(s[16]=o=>e("."))},"."),t("div",{class:"item bold red",onClick:s[17]||(s[17]=o=>e("10"))},"\uFFE510")])]),t("div",Ss,[t("div",{class:"item confirm",onClick:s[18]||(s[18]=o=>e("confirm"))},"\u786E\u5B9A")])])]))}});const Vs=T(Us,[["__scopeId","data-v-eaa1110b"]]),M=n=>(W("data-v-6acb236a"),n=n(),X(),n),Rs={class:"content"},Ls={class:"left"},Ts={class:"money-box"},Ps={class:"itme"},zs=M(()=>t("div",{class:"name"},"\u5E94\u6536",-1)),Os={class:"price"},Ns={class:"itme"},Ys=M(()=>t("div",{class:"name"},"\u5B9E\u6536",-1)),js={class:"price"},Ms={class:"itme"},Hs=M(()=>t("div",{class:"name"},"\u627E\u96F6",-1)),Js={class:"price red"},Ks={class:"img"},Gs={class:"countdown"},Ws=M(()=>t("div",{class:"state"},"\u652F\u4ED8\u72B6\u6001\uFF1A\u7B49\u5F85\u652F\u4ED8",-1)),Xs={key:2},Qs={class:"right"},qs=M(()=>t("div",null,"\u4F1A\u5458\u652F\u4ED8",-1)),Zs=M(()=>t("div",null,"\u626B\u7801\u652F\u4ED8",-1)),en=M(()=>t("div",null,"\u73B0\u91D1\u652F\u4ED8",-1)),tn={class:"print"},sn=V({__name:"pay",props:{visible:{type:Boolean,default:!1}},emits:["cancel"],setup(n,{emit:u}){const l=n,{cart:e,emptyCart:_}=L("cart"),s=D(),o=D(0),r=D(0),C=D(!0),$=D(2),v=D(0),w=Y(()=>l.visible),k=()=>{u("cancel",!1)},b=E=>{$.value=E},p=()=>{v.value=3},a=E=>{v.value=1},i=()=>{v.value=0,ae(()=>{s.value.focus()})},g=E=>{o.value=E.value,o.value-e.value.total>0?r.value=o.value-e.value.total:r.value=0},y=E=>{E&&(_(),k())};return te(()=>l.visible,E=>{E===!0&&(v.value=0,$.value=2,o.value=e.value.total,ae(()=>{s.value&&s.value.focus()}))}),(E,I)=>{const x=Q,P=Ve,U=Re,se=Ce,de=le,Fe=Le,$e=Te,q=j,ne=Pe,oe=ze,xe=Oe,Ee=G;return m(),A(Ee,{visible:f(w),closable:!1,footer:!1,"mask-closable":!1,width:"800px","body-class":"modal-body","body-style":{padding:"20px",backgroundColor:"var(--color-neutral-2)"},onCancel:k},{default:c(()=>[t("div",Rs,[t("div",Ls,[d(x,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"15px"}},{default:c(()=>[t("div",Ts,[t("div",Ps,[zs,t("div",Os,"\uFFE5"+F(f(N)(f(e).total)),1)]),t("div",Ns,[Ys,t("div",js,"\uFFE5"+F(f(N)(String(o.value))),1)]),t("div",Ms,[Hs,t("div",Js,"\uFFE5"+F(f(N)(String(r.value))),1)])])]),_:1}),$.value===1?(m(),A(x,{key:0,class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"20px",marginTop:"20px",height:"265px"}},{default:c(()=>[d(U,{column:2},{default:c(()=>[d(P,{label:"\u6635\u79F0"},{default:c(()=>[h(F(f(e).user.nickname),1)]),_:1}),d(P,{label:"\u624B\u673A\u53F7"},{default:c(()=>[h(F(f(e).user.cellphone),1)]),_:1}),d(P,{label:"\u4F1A\u5458\u5361\u4F59\u989D"},{default:c(()=>[h(F(f(e).user.money),1)]),_:1}),d(P,{label:"\u6D88\u8D39\u540E\u4F59\u989D"},{default:c(()=>[h(" 0.00 ")]),_:1})]),_:1}),d(se,{class:"buttom",placeholder:"\u70B9\u51FB\u805A\u7126\u626B\u7801\u6216\u8F93\u5165\u652F\u4ED8\u5BC6\u7801","button-text":"\u786E\u8BA4","search-button":""})]),_:1})):$.value===2?(m(),A(x,{key:1,class:"general-card code-box","header-style":{paddingBottom:"0"},"body-style":{padding:"20px",marginTop:"20px",height:"265px"}},{default:c(()=>[t("div",Ks,[v.value===0?(m(),B(R,{key:0},[d(de,{height:"225",src:f($s),preview:!1},null,8,["src"]),d(Fe,{ref_key:"productIdRef",ref:s,style:{opacity:"0"},onChange:a},null,512)],64)):v.value===1?(m(),B(R,{key:1},[t("div",Gs,[d($e,{value:Date.now()+60*1e3,"value-style":{color:"#fff"},format:"ss",now:Date.now(),onFinish:p},null,8,["value","now"])]),Ws,d(q,{type:"primary",status:"danger",onClick:i},{default:c(()=>[h("\u53D6\u6D88\u652F\u4ED8")]),_:1})],64)):v.value===2?(m(),A(oe,{key:2,status:"success",title:"\u652F\u4ED8\u6210\u529F"},{extra:c(()=>[d(ne,null,{default:c(()=>[d(q,{type:"primary",onClick:k},{default:c(()=>[h("\u786E\u5B9A")]),_:1})]),_:1})]),_:1})):v.value===3?(m(),A(oe,{key:3,status:"error",title:"\u957F\u671F\u672A\u64CD\u4F5C\uFF0C\u8BF7\u91CD\u65B0\u53D1\u8D77\u626B\u7801\u652F\u4ED8"},{extra:c(()=>[d(ne,null,{default:c(()=>[d(q,{type:"primary",onClick:i},{default:c(()=>[h("\u8FD4\u56DE")]),_:1})]),_:1})]),_:1})):v.value===4?(m(),A(oe,{key:4,status:"warning",title:"\u7528\u6237\u53D6\u6D88\u652F\u4ED8\uFF0C\u8BF7\u91CD\u65B0\u53D1\u8D77\u626B\u7801\u652F\u4ED8"},{extra:c(()=>[d(ne,null,{default:c(()=>[d(q,{type:"primary",onClick:i},{default:c(()=>[h("\u8FD4\u56DE")]),_:1})]),_:1})]),_:1})):K("",!0)])]),_:1})):$.value===3?(m(),B("div",Xs,[d(Vs,{onKey:g,onConfirm:y})])):K("",!0)]),t("div",Qs,[d(x,{class:"general-card cancel","header-style":{paddingBottom:"0"},"body-style":{padding:"15px"},onClick:k},{default:c(()=>[h(" \u53D6\u6D88 ")]),_:1}),f(e).user?(m(),A(x,{key:0,class:H(["general-card item-box",{on:$.value===1}]),"header-style":{paddingBottom:"0"},"body-style":{padding:"15px",marginTop:"20px"},onClick:I[0]||(I[0]=Z=>b(1))},{default:c(()=>[qs]),_:1},8,["class"])):K("",!0),d(x,{class:H(["general-card item-box",{on:$.value===2}]),"header-style":{paddingBottom:"0"},"body-style":{padding:"15px",marginTop:"20px"},onClick:I[1]||(I[1]=Z=>b(2))},{default:c(()=>[Zs]),_:1},8,["class"]),d(x,{class:H(["general-card item-box",{on:$.value===3}]),"header-style":{paddingBottom:"0"},"body-style":{padding:"15px",marginTop:"20px"},onClick:I[2]||(I[2]=Z=>b(3))},{default:c(()=>[en]),_:1},8,["class"]),t("div",tn,[d(xe,{modelValue:C.value,"onUpdate:modelValue":I[3]||(I[3]=Z=>C.value=Z)},{default:c(()=>[h("\u652F\u4ED8\u5B8C\u6210\u6253\u5370\u5C0F\u7968")]),_:1},8,["modelValue"])])])])]),_:1},8,["visible","body-style"])}}});const nn=T(sn,[["__scopeId","data-v-6acb236a"]]),on={class:"container"},an={class:"left-side"},un={class:"panel"},ln={class:"right-side"},cn={name:"Cashier"},dn=V({...cn,setup(n){const u=D(!1),l=D(),e=D({uuid:"",commodity:[],sum:0,total:0,user:null,time:""}),_=!1,s=D();s.value=localStorage.getItem("order-pending")?JSON.parse(String(localStorage.getItem("order-pending"))):[];function o(a){l.value=a}function r(a){if(!e.value.uuid)e.value.uuid=ue().replace(/[-]/g,""),Reflect.has(a,"ids")?(e.value.commodity.push({id:a.id,number:a.number,sku:[]}),e.value.commodity[0].sku.push(a)):e.value.commodity.push(a);else{let i=!0,g=!0;e.value.commodity.map(y=>(y.id===a.id&&(Reflect.has(y,"sku")&&(y.sku.map(E=>(E.product.every((I,x)=>I.value===a.product[x].value)&&(E.number+=a.number,g=!1),E)),g&&y.sku.unshift(a)),y.number+=a.number,i=!1),y)),i&&(Reflect.has(a,"ids")?(e.value.commodity.unshift({id:a.id,number:a.number,sku:[]}),e.value.commodity[0].sku.unshift(a)):e.value.commodity.unshift(a))}e.value.user=l.value,O.success("\u52A0\u8D2D\u6210\u529F")}function C(a,i){i!==-1?(e.value.commodity[a].sku.splice(i,1),e.value.commodity[a].sku.length===0&&e.value.commodity.splice(a,1)):e.value.commodity.splice(a,1),O.success("\u5220\u9664\u6210\u529F")}function $(){e.value.commodity=[],e.value.sum=0,e.value.total=0,O.success("\u6E05\u7A7A\u6210\u529F")}function v(a){e.value=a,a.user?l.value=a.user:l.value=null}function w(){if(e.value.commodity.length===0)O.error("\u8BF7\u5148\u6DFB\u52A0\u5546\u54C1");else{e.value.user=l.value,e.value.sum=0,e.value.total=0;let a=!0;e.value.commodity.forEach(i=>{Reflect.has(i,"sku")?i.sku.forEach(g=>{e.value.sum+=g.number,e.value.total+=g.number*g.price}):(e.value.sum+=i.number,e.value.total+=i.number*i.price)}),e.value.total=parseFloat(e.value.total.toFixed(2)),e.value.time=re().format("YYYY-MM-DD HH:mm:ss"),s.value.map(i=>(i.uuid===e.value.uuid&&(i=e.value,a=!1),i)),a&&s.value.unshift(e.value),localStorage.setItem("order-pending",JSON.stringify(s.value)),e.value={uuid:"",commodity:[],sum:0,total:0,user:null,time:null},l.value=null,O.success("\u6302\u5355\u6210\u529F")}}function k(a){s.value.splice(a,1),localStorage.setItem("order-pending",JSON.stringify(s.value)),O.success("\u5220\u9664\u6210\u529F")}function b(){s.value=[],localStorage.removeItem("order-pending"),O.success("\u6E05\u7A7A\u6210\u529F")}function p(){e.value.user=l.value,e.value.sum=0,e.value.total=0,e.value.commodity.forEach(a=>{Reflect.has(a,"sku")?a.sku.forEach(i=>{e.value.sum+=i.number,e.value.total+=i.number*i.price}):(e.value.sum+=a.number,e.value.total+=a.number*a.price)}),e.value.total=parseFloat(e.value.total.toFixed(2)),e.value.time=re().format("YYYY-MM-DD HH:mm:ss")}return J("pending",{pending:s,addPending:w,deletePending:k,emptyPending:b}),J("user",{user:l,updateUser:o}),J("isDefaultUser",_),J("cart",{cart:e,updateCart:r,deleteCart:C,emptyCart:$,pendingToCart:v}),J("clearing",p),Ne((a,i,g)=>{e.value.commodity.length===0?g():G.info({title:"\u63D0\u793A",content:"\u79BB\u5F00\u5F53\u524D\u9875\uFF0C\u5F53\u524D\u8D2D\u7269\u8F66\u5C06\u88AB\u6E05\u7A7A\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",hideCancel:!1,onOk:()=>{g()}})}),(a,i)=>(m(),B("div",on,[t("div",an,[t("div",un,[d(Mt,{onClearing:i[0]||(i[0]=g=>u.value=!0)})])]),t("div",ln,[d(Fs)]),d(nn,{visible:u.value,onCancel:i[1]||(i[1]=g=>u.value=!1)},null,8,["visible"])]))}});const xn=T(dn,[["__scopeId","data-v-f4d83815"]]);export{xn as default};
